(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},156:function(e,t){},159:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(10),c=n.n(s),u=(n(103),n(30)),i=(n(104),n(57)),o=n.n(i),l=n(83),j=n(203),f=n(197),d=n(198),m=n(90),b=n.n(m),v=n(84),g=n.n(v),p=n(6),h=function(e){var t=e.setUserDataForChat,n=Object(a.useRef)(""),r=Object(a.useRef)(""),s=function(e,n){if(!e.trim().length)return!1;if(void 0===n)t({user_name:e});else{var a=new FormData;a.append("avatar",n),c(a).then((function(n){console.log(n),t({user_name:e,user_avatar:n.data.user_avatar_url})})).catch((function(e){console.log(e)}))}},c=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("http://localhost:5002/api/upload",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{className:"form",children:[Object(p.jsx)(j.a,{label:"Enter Username",variant:"outlined",margin:"normal",fullWidth:!0,inputRef:n,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),s(e.target.value,r.current.files[0]))}}),Object(p.jsxs)("label",{children:[Object(p.jsx)("input",{style:{display:"none"},id:"upload-avatar",name:"upload-avatar",ref:r,type:"file",accept:"image/x-png,image/gif,image/jpeg,image/png"}),Object(p.jsxs)(f.a,{color:"inherit",size:"small",component:"span","aria-label":"add",variant:"extended",children:[Object(p.jsx)(b.a,{})," Upload avatar"]})]}),Object(p.jsx)(d.a,{style:{marginLeft:"32%"},variant:"contained",color:"primary",onClick:function(){console.log(n.current.value,r.current.files[0]),s(n.current.value,r.current.files[0])},children:"Enter Chat"})]})},O=function(e){var t=Object(a.useState)(""),n=Object(u.a)(t,2),r=n[0],s=n[1],c=Object(a.useRef)(""),i=function(){if(""===c.current.value)return!1;var t={user_name:e.userData.currentUserData.user_name,user_avatar:e.userData.currentUserData.user_avatar,message:c.current.value};e.onSendMessage(t),s("")};return Object(p.jsxs)("form",{className:"chat-form",autoComplete:"off",children:[Object(p.jsx)(j.a,{id:"standard-basic",label:"Write your message here",margin:"normal",multiline:!0,fullWidth:!0,rows:"4",inputRef:c,onChange:function(e){return s(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),i())},value:r}),Object(p.jsx)(d.a,{variant:"contained",color:"primary",onClick:i,children:"Send"})]})},x=n(196),_=n(199),y=n(202),D=n(201),C=n(200),w=n(204),M=n(49),k=function(e){var t=e.messages;return Object(p.jsx)(x.a,{children:t.flatMap((function(e,t){return[Object(p.jsxs)(_.a,{alignItems:"flex-start",children:[Object(p.jsx)(C.a,{children:Object(p.jsx)(w.a,{alt:"Avatar alt text",src:e.user_avatar})}),Object(p.jsx)(D.a,{primary:e.user_name,secondary:Object(p.jsx)(a.Fragment,{children:Object(p.jsx)(M.a,{component:"span",variant:"body2",color:"textPrimary",children:e.message_text})})})]},t),Object(p.jsx)(y.a,{variant:"inset",component:"li"},"divider-"+t)]}))})},F=n(58),S=n(91),R=n.n(S),U=function(){var e=Object(a.useRef)(),t=Object(a.useState)([]),n=Object(u.a)(t,2),r=n[0],s=n[1];Object(a.useEffect)((function(){return e.current=R()("http://localhost:5005",{transports:["websocket"]}),e.current.on("mostRecentMessages",(function(e){console.log(e),s((function(t){return Object(F.a)(e)}))})),e.current.on("newChatMessage",(function(e){var t=e.user_name,n=e.user_avatar,a=e.message_text;s((function(e){return[].concat(Object(F.a)(e),[{user_name:t,user_avatar:n,message_text:a}])}))})),function(){e.current.disconnect()}}),[]);return{messages:r,sendMessage:function(t){e.current.emit("newChatMessage",t)}}},E=function(e){var t=U(),n=t.messages,a=t.sendMessage;return Object(p.jsxs)("div",{children:[Object(p.jsx)(k,{messages:n}),Object(p.jsx)(O,{userData:e,onSendMessage:function(e){a(e)}})]})};var N=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1];return null===n?Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("div",{className:"container-title",children:"Welcome to Chat"}),Object(p.jsx)(h,{setUserDataForChat:r})]}):Object(p.jsx)(E,{currentUserData:n})},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,206)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))};c.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(N,{})}),document.getElementById("root")),W()}},[[159,1,2]]]);
//# sourceMappingURL=main.5f6da80f.chunk.js.map